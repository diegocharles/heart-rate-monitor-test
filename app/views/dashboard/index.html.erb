<div class="space-y-6">
  <!-- Overall Stats Card -->
  <div class="card">
    <div class="card-header">
      <h3 class="text-lg font-medium leading-6 text-gray-900">Overall Heart Rate Statistics</h3>
    </div>
    <div class="card-body">
      <dl class="grid grid-cols-1 gap-5 sm:grid-cols-3">
        <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
          <dt class="truncate text-sm font-medium text-gray-500">Minimum Heart Rate</dt>
          <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= @overall_stats[:min_heart_rate] %> BPM</dd>
        </div>
        <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
          <dt class="truncate text-sm font-medium text-gray-500">Maximum Heart Rate</dt>
          <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= @overall_stats[:max_heart_rate] %> BPM</dd>
        </div>
        <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
          <dt class="truncate text-sm font-medium text-gray-500">Average Heart Rate</dt>
          <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= @overall_stats[:avg_heart_rate] %> BPM</dd>
        </div>
      </dl>
    </div>
  </div>

  <!-- Zone Percentages -->
  <div class="card">
    <div class="card-header">
      <h3 class="text-lg font-medium leading-6 text-gray-900">Time Spent in Heart Rate Zones</h3>
    </div>
    <div class="card-body">
      <div class="space-y-8">
        <% @zone_percentages.each do |user_data| %>
          <div>
            <h4 class="text-base font-medium text-gray-900 mb-4"><%= user_data[:user].username %></h4>
            <div class="grid grid-cols-1 gap-4 sm:grid-cols-4">
              <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
                <dt class="truncate text-sm font-medium text-gray-500">Zone 1</dt>
                <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= user_data[:percentages][:zone1] %>%</dd>
                <div class="mt-2">
                  <div class="h-2 bg-gray-200 rounded-full">
                    <div class="h-2 bg-green-500 rounded-full" style="width: <%= user_data[:percentages][:zone1] %>%"></div>
                  </div>
                </div>
              </div>
              <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
                <dt class="truncate text-sm font-medium text-gray-500">Zone 2</dt>
                <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= user_data[:percentages][:zone2] %>%</dd>
                <div class="mt-2">
                  <div class="h-2 bg-gray-200 rounded-full">
                    <div class="h-2 bg-yellow-500 rounded-full" style="width: <%= user_data[:percentages][:zone2] %>%"></div>
                  </div>
                </div>
              </div>
              <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
                <dt class="truncate text-sm font-medium text-gray-500">Zone 3</dt>
                <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= user_data[:percentages][:zone3] %>%</dd>
                <div class="mt-2">
                  <div class="h-2 bg-gray-200 rounded-full">
                    <div class="h-2 bg-orange-500 rounded-full" style="width: <%= user_data[:percentages][:zone3] %>%"></div>
                  </div>
                </div>
              </div>
              <div class="overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:p-6">
                <dt class="truncate text-sm font-medium text-gray-500">Zone 4</dt>
                <dd class="mt-1 text-3xl font-semibold tracking-tight text-gray-900"><%= user_data[:percentages][:zone4] %>%</dd>
                <div class="mt-2">
                  <div class="h-2 bg-gray-200 rounded-full">
                    <div class="h-2 bg-red-500 rounded-full" style="width: <%= user_data[:percentages][:zone4] %>%"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Recent Sessions -->
  <div class="card">
    <div class="card-header">
      <h3 class="text-lg font-medium leading-6 text-gray-900">Recent Sessions</h3>
    </div>
    <div class="card-body">
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Duration</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Min BPM</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Max BPM</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg BPM</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            <% @sessions.each do |session| %>
              <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"><%= session.user.username %></td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= session.created_at.strftime("%B %d, %Y") %></td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= session.duration_in_secs / 60 %> minutes</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= session.hrm_data_points.minimum(:beats_per_minute) %></td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= session.hrm_data_points.maximum(:beats_per_minute) %></td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= session.hrm_data_points.average(:beats_per_minute).to_i %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
